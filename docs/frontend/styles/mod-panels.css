/* SPECTRA-PRO mod UI (Phase 1) */
#spectraProPanel {
  position: fixed;
  right: 12px;
  bottom: 12px;
  z-index: 99999;
  width: min(360px, calc(100vw - 24px));
  background: rgba(13, 20, 33, 0.96);
  color: #e9f2ff;
  border: 1px solid #334b70;
  border-radius: 12px;
  box-shadow: 0 10px 30px rgba(0,0,0,.35);
  backdrop-filter: blur(6px);
}
#spectraProPanel .sp-head { display:flex; align-items:center; justify-content:space-between; gap:8px; padding:8px 10px; border-bottom:1px solid #243750; }
#spectraProPanel .sp-body { padding:8px 10px; }
#spectraProPanel .sp-status { margin-top:8px; font-size:12px; line-height:1.35; color:#d9e6ff; }
#spectraProPanel .sp-status .muted { color:#9fb2cf; }
.sp-mode-tabs { display:flex; gap:6px; margin-top:2px; }
.sp-mode-tabs button {
  border:1px solid #3b5175; background:#162238; color:#dce9ff; border-radius:8px; padding:5px 9px; font-size:12px;
}
.sp-mode-tabs button.active { background:#223b5b; border-color:#79a7dd; box-shadow: inset 0 0 0 1px rgba(255,255,255,.08); }
.sp-pill { display:inline-block; border:1px solid #375173; border-radius:999px; padding:1px 7px; font-size:11px; }
.sp-pill.ok { border-color:#4f8c68; color:#bde9ca; }
.sp-pill.warn { border-color:#9d8c43; color:#f5e7a9; }
.sp-pill.bad { border-color:#9a4f4f; color:#ffc6c6; }


/* P2-LAB polish */
#spectraProPanel .btn, #spectraProPanel button{ background:#1a2e52; color:#e8f1ff; border:1px solid #2c4f86; }
#spectraProPanel .btn:hover, #spectraProPanel button:hover{ background:#234171; }
#spectraProPanel .btn-secondary{ background:#163357; border-color:#2d5f9c; }
#spectraProPanel .btn-primary{ background:#1f4f8a; border-color:#3c79c0; }
#spectraProPanel .sp-tophits{ margin-top:8px; display:flex; flex-direction:column; gap:6px; max-height:180px; overflow:auto; }
#spectraProPanel .sp-hit{ display:grid; grid-template-columns:22px 1fr auto auto; gap:6px; align-items:center; font-size:12px; padding:4px 6px; border:1px solid rgba(120,160,220,.25); border-radius:8px; background:rgba(9,18,34,.45); }
#spectraProPanel .sp-rank{ opacity:.8; }
#spectraProPanel .sp-name{ font-weight:600; }
#spectraProPanel .sp-nm, #spectraProPanel .sp-conf{ color:#bcd2ff; }


/* Docked layout (Phase 2.1 hotfix3) */
#spectraProDockHost{display:block; width:100%; margin:8px 0 0 0;}
#spectraProPanel.sp-inline-panel{
  position: static !important;
  right:auto !important; left:auto !important; top:auto !important; bottom:auto !important;
  width:100% !important; max-width:none !important; min-width:0 !important;
  margin:0 !important; z-index: 20 !important;
  border-radius:10px;
  overflow:hidden;
}
#spectraProPanel .sp-main{display:grid; grid-template-columns:minmax(0,1fr) 360px; gap:12px; align-items:start;}
#spectraProPanel .sp-tabs-row{display:contents;}
#spectraProPanel .sp-tabs{display:flex; gap:8px; flex-wrap:wrap; padding:10px 12px; border-bottom:1px solid #243750;}
#spectraProPanel .sp-tab{border:1px solid #1fcf88; color:#68f0bf; background:#071733; border-radius:7px; padding:6px 12px; font-weight:600;}
#spectraProPanel .sp-tab.is-active{background:#0d2648; box-shadow: inset 0 0 0 1px rgba(104,240,191,.15);}
#spectraProPanel .sp-statusdock{grid-column:2; grid-row:1 / span 2; padding:10px 12px 12px; border-left:1px solid #243750;}
#spectraProPanel .sp-brandrow{display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;}
#spectraProPanel .sp-brand{font-weight:800; letter-spacing:.03em;}
#spectraProPanel .sp-badge{font-size:11px; border:1px solid #47638c; border-radius:999px; padding:1px 7px;}
#spectraProPanel .sp-card{border:1px solid #223754; background:rgba(9,18,34,.35); border-radius:10px; padding:8px 10px; margin-bottom:10px;}
#spectraProPanel .sp-card-title{text-transform:uppercase; font-size:11px; letter-spacing:.05em; color:#bcd2ff; margin-bottom:6px; font-weight:700;}
#spectraProPanel .sp-panels{grid-column:1; grid-row:2; min-width:0; padding:0 12px 12px;}
#spectraProPanel .sp-tabpanel{display:none; min-height:140px; border:1px solid #1c3050; border-radius:10px; padding:10px; background:rgba(5,14,28,.25);}
#spectraProPanel .sp-tabpanel.is-active{display:block;}
#spectraProPanel .sp-grid2{display:grid; grid-template-columns:repeat(2,minmax(0,1fr)); gap:10px;}
#spectraProPanel .sp-row{display:flex; gap:8px; flex-wrap:wrap; margin-top:10px;}
#spectraProPanel label{display:flex; flex-direction:column; gap:4px; font-size:12px; color:#cfe0ff;}
#spectraProPanel select,#spectraProPanel input{max-width:100%; background:#0c1a30; color:#e9f2ff; border:1px solid #294568; border-radius:6px; padding:5px 6px;}
#spectraProPanel .sp-note{margin-top:10px; font-size:12px; color:#9fb2cf;}
#spectraProPanel .sp-status{font-size:12px; line-height:1.35;}
#spectraProPanel .sp-status .muted{color:#9fb2cf;}

/* Prevent extra page scrollbar from dock content */
#graphSettingsDrawer{overflow:visible;}
#graphSettingsDrawerLeft,#graphSettingsDrawerRight{overflow:visible;}
body{overflow:hidden;}

@media (max-width: 1400px){
  #spectraProPanel .sp-main{grid-template-columns:1fr 320px;}
}
@media (max-width: 1100px){
  #spectraProPanel .sp-main{grid-template-columns:1fr;}
  #spectraProPanel .sp-statusdock{grid-column:1; grid-row:auto; border-left:none; border-top:1px solid #243750;}
  #spectraProPanel .sp-panels{grid-row:auto;}
}


/* Hotfix 2.1.4: match actual DOM structure (tabs/status are siblings) */
#spectraProPanel.sp-inline-panel{display:grid; grid-template-columns:minmax(0,1fr) 360px; grid-template-rows:auto auto; gap:0 12px; align-items:start;}
#spectraProPanel .sp-tabs-row{grid-column:1 / 2; grid-row:1; display:block;}
#spectraProPanel .sp-tabs{border-bottom:none;}
#spectraProPanel .sp-main{grid-column:1 / 2; grid-row:2; display:block; min-width:0;}
#spectraProPanel .sp-panels{padding:0 12px 12px;}
#spectraProPanel .sp-statusdock{grid-column:2; grid-row:1 / span 2; width:auto; border-left:1px solid #243750; padding:10px 12px 12px;}
#spectraProPanel .sp-tabpanel{min-height:110px;}
@media (max-width: 1100px){
  #spectraProPanel.sp-inline-panel{grid-template-columns:1fr; grid-template-rows:auto auto auto;}
  #spectraProPanel .sp-tabs-row{grid-column:1; grid-row:1;}
  #spectraProPanel .sp-main{grid-column:1; grid-row:2;}
  #spectraProPanel .sp-statusdock{grid-column:1; grid-row:3; border-left:none; border-top:1px solid #243750;}
}


/* ==== Phase 2.1 dock/layout hotfix ==== */
#graphCanvasContainer { overflow: hidden; }
#spectraProDockHost.sp-dock-host {
  width: calc(100% - 16px);
  max-width: calc(100% - 16px);
  margin: 8px 8px 0;
  box-sizing: border-box;
  overflow: hidden;
}

/* Keep the PRO panel in normal flow, not floating */
.sp-inline-panel.sp-docked {
  position: relative !important;
  right: auto !important;
  bottom: auto !important;
  width: 100% !important;
  max-width: 100% !important;
  margin: 0 !important;
  z-index: 3;
}

/* Make sure drawer arrows/toggles stay clickable/visible */
#graphSettingsDrawerLeft, #graphSettingsDrawerRight,
#hideGraphSettingsDrawerLeftButton, #hideGraphSettingsDrawerRightButton {
  position: relative;
  z-index: 20;
}

/* Prevent inner content from creating a vertical scrollbar */
.sp-inline-main {
  display: grid;
  grid-template-columns: minmax(0,1fr) 360px;
  gap: 12px;
  align-items: start;
}
.sp-inline-body { min-width: 0; }
.sp-inline-right {
  width: 360px;
  min-width: 0;
}
.sp-inline-content {
  min-height: 150px;
  max-height: none;
  overflow: hidden;
}
.sp-inline-section.active {
  display: block;
}

@media (max-width: 1200px) {
  .sp-inline-main {
    grid-template-columns: 1fr;
  }
  .sp-inline-right {
    width: 100%;
  }
}

/* --- SPECTRA-PRO dock (current proBootstrap DOM) --- */
#spectraProPanel{
  position:relative;
  margin-top:8px;
  border:1px solid rgba(125,211,252,.18);
  border-radius:10px;
  background:linear-gradient(180deg, rgba(7,17,38,.95), rgba(4,14,34,.97));
  overflow:visible;
}
#spectraProPanel .sp-shell{ position:relative; }
#spectraProPanel .sp-dock-toggle{
  position:absolute; right:8px; top:8px; z-index:3;
  width:18px; height:18px; padding:0; border-radius:4px;
  border:1px solid rgba(125,211,252,.25); background:#10284d; color:#dbeafe; cursor:pointer;
}
#spectraProPanel .sp-root{
  display:grid; grid-template-columns:minmax(0,1fr) 320px; gap:12px;
  padding:10px 12px 12px; align-items:start;
}
#spectraProPanel .sp-root.hidden{ display:none; }
#spectraProPanel .sp-main{ min-width:0; }
#spectraProPanel .sp-tabbar{ display:flex; flex-wrap:wrap; gap:8px; margin-bottom:10px; }
#spectraProPanel .sp-tab{
  border:1px solid rgba(16,185,129,.75);
  background:#071b36; color:#8fffe0; border-radius:8px; padding:6px 12px; font-weight:700; cursor:pointer;
}
#spectraProPanel .sp-tab.is-active{ background:#0b2d4f; box-shadow:0 0 0 1px rgba(16,185,129,.25) inset; }
#spectraProPanel .sp-tabpanels{ min-height:140px; }
#spectraProPanel .sp-tabpanel{ display:none; border:1px solid rgba(125,211,252,.12); border-radius:10px; padding:10px; background:rgba(4,14,34,.45); }
#spectraProPanel .sp-tabpanel.is-active{ display:block; }
#spectraProPanel .sp-note{ color:#bcd0ea; font-size:12px; }
#spectraProPanel .sp-form-grid{ display:grid; grid-template-columns:repeat(2,minmax(0,1fr)); gap:10px; }
#spectraProPanel .sp-field{ display:flex; flex-direction:column; gap:4px; color:#dbeafe; font-size:12px; }
#spectraProPanel .sp-field select{ width:100%; }
#spectraProPanel .sp-form-grid button,
#spectraProPanel .sp-field select{
  min-height:32px; border-radius:8px; border:1px solid rgba(125,211,252,.22);
  background:#10284d; color:#e6f0ff; padding:6px 10px;
}
#spectraProPanel .sp-status-rail{ min-width:0; display:grid; gap:10px; }
#spectraProPanel .sp-brand-row{ display:flex; align-items:center; justify-content:space-between; gap:8px; color:#eef6ff; font-weight:800; }
#spectraProPanel .sp-brand{ letter-spacing:.03em; }
#spectraProPanel .sp-mode-badge{ border:1px solid rgba(125,211,252,.3); border-radius:999px; padding:2px 8px; font-size:11px; color:#bcd0ea; }
#spectraProPanel .sp-card{ border:1px solid rgba(125,211,252,.16); border-radius:10px; padding:10px; background:rgba(4,14,34,.55); }
#spectraProPanel .sp-card h4{ margin:0 0 6px; font-size:12px; color:#bcd0ea; }
#spectraProPanel .sp-list{ color:#e6f0ff; font-size:12px; line-height:1.4; }
#spectraProPanel .sp-list .muted{ color:#91a7c5; }
#spectraProPanel .sp-list ul{ margin:0; padding-left:16px; }
#spectraProPanel .sp-list li{ margin:2px 0; }

@media (max-width: 1200px){
  #spectraProPanel .sp-root{ grid-template-columns:1fr; }
  #spectraProPanel .sp-status-rail{ grid-template-columns:repeat(3,minmax(0,1fr)); }
}
@media (max-width: 820px){
  #spectraProPanel .sp-form-grid{ grid-template-columns:1fr; }
  #spectraProPanel .sp-status-rail{ grid-template-columns:1fr; }
}
